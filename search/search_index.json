{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Kedge","text":"<p>GitOps for Docker Compose. Push to Git, your containers update automatically.</p> <pre><code>kedge repo add https://github.com/you/app &amp;&amp; kedge serve\n</code></pre>"},{"location":"#how-it-works","title":"How It Works","text":"<ol> <li>You push to your Git repository</li> <li>Kedge detects the change and pulls</li> <li>Docker Compose stack updates automatically</li> <li>Drift happens? Kedge fixes it</li> </ol>"},{"location":"#install","title":"Install","text":"<pre><code>go install github.com/LoriKarikari/kedge/cmd/kedge@latest\n</code></pre> <p>Or with Docker:</p> <pre><code>docker pull ghcr.io/lorikarikari/kedge:latest\n</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":"<p>1. Add <code>kedge.yaml</code> to your repo:</p> <pre><code>docker:\n  project_name: myapp\n  compose_file: docker-compose.yaml\n</code></pre> <p>2. Register and run:</p> <pre><code>kedge repo add https://github.com/you/your-app\nkedge serve\n</code></pre> <p>Done. Push to Git and watch it deploy.</p>"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li>Getting Started \u2014 Full setup guide</li> <li>Core Concepts \u2014 Understand reconciliation and drift</li> <li>Configuration \u2014 All config options</li> <li>CLI Reference \u2014 Every command documented</li> </ul>"},{"location":"concepts/","title":"Core Concepts","text":"<p>Understanding how Kedge works.</p>"},{"location":"concepts/#repositories","title":"Repositories","text":"<p>A repository in Kedge is a Git repository containing:</p> <ul> <li>A <code>docker-compose.yaml</code> (or similar) defining your services</li> <li>A <code>kedge.yaml</code> configuration file</li> </ul> <p>Kedge clones repositories locally, watches them for changes, and deploys the Docker Compose stack.</p>"},{"location":"concepts/#repository-lifecycle","title":"Repository Lifecycle","text":"<pre><code>Register \u2192 Clone \u2192 Deploy \u2192 Watch \u2192 Reconcile\n</code></pre> <ol> <li>Register: <code>kedge repo add &lt;url&gt;</code> saves the repository to the database</li> <li>Clone: On <code>kedge serve</code>, repositories are cloned to <code>.kedge/repos/&lt;name&gt;/</code></li> <li>Deploy: The Docker Compose stack is deployed</li> <li>Watch: Kedge polls for Git changes (default: every 60 seconds)</li> <li>Reconcile: When changes are detected, Kedge updates the deployment</li> </ol>"},{"location":"concepts/#managing-repositories","title":"Managing Repositories","text":"<pre><code># Add a repository\nkedge repo add https://github.com/acme/app --branch main\n\n# List all repositories\nkedge repo list\n\n# Remove a repository\nkedge repo remove myapp\n</code></pre>"},{"location":"concepts/#reconciliation","title":"Reconciliation","text":"<p>Reconciliation is the process of making the actual state match the desired state.</p> <ul> <li>Desired state: What's defined in your <code>docker-compose.yaml</code></li> <li>Actual state: What's currently running in Docker</li> </ul>"},{"location":"concepts/#reconciliation-triggers","title":"Reconciliation Triggers","text":"<p>Kedge reconciles when:</p> <ol> <li>Git changes: A new commit is detected on the watched branch</li> <li>Drift detected: Running containers don't match the compose file</li> <li>Manual sync: You run <code>kedge sync --repo &lt;name&gt;</code></li> </ol>"},{"location":"concepts/#reconciliation-modes","title":"Reconciliation Modes","text":"<p>Configure the mode in <code>kedge.yaml</code>:</p> <pre><code>reconciliation:\n  mode: auto\n</code></pre> Mode Behavior Use Case <code>auto</code> Automatically apply all changes Production with confidence <code>notify</code> Log changes but don't apply Review before applying <code>manual</code> Wait for <code>kedge sync</code> Full manual control"},{"location":"concepts/#example-auto-mode","title":"Example: Auto Mode","text":"<pre><code>Git push detected \u2192 Pull changes \u2192 Compare state \u2192 Apply changes \u2192 Done\n</code></pre>"},{"location":"concepts/#example-manual-mode","title":"Example: Manual Mode","text":"<pre><code>Git push detected \u2192 Pull changes \u2192 Compare state \u2192 Log diff \u2192 Wait\n                                                            \u2193\n                              kedge sync --repo myapp \u2192 Apply changes \u2192 Done\n</code></pre>"},{"location":"concepts/#drift-detection","title":"Drift Detection","text":"<p>Drift is when the actual state diverges from the desired state. This can happen when:</p> <ul> <li>A container crashes or is manually stopped</li> <li>Someone manually changes a container (different image, env vars)</li> <li>A container is deleted</li> <li>Docker daemon restarts</li> </ul>"},{"location":"concepts/#types-of-drift","title":"Types of Drift","text":"Drift Type Description Example Missing Service defined but container doesn't exist Container was deleted Stopped Container exists but isn't running Container crashed Wrong Image Container running different image Manual <code>docker pull</code> + restart Extra Container exists but not in compose Orphaned from old config"},{"location":"concepts/#viewing-drift","title":"Viewing Drift","text":"<pre><code>kedge diff --repo myapp\n</code></pre> <p>Example output:</p> <pre><code>Service: web\n  Status: Image mismatch\n  Expected: nginx:1.25\n  Actual: nginx:1.24\n\nService: worker\n  Status: Not running\n  Expected: running\n  Actual: exited\n</code></pre>"},{"location":"concepts/#drift-resolution","title":"Drift Resolution","text":"<p>In <code>auto</code> mode, Kedge automatically fixes drift:</p> <ul> <li>Missing/Stopped: Recreate and start the container</li> <li>Wrong Image: Pull correct image and recreate container</li> <li>Extra: Remove orphaned containers (configurable)</li> </ul>"},{"location":"concepts/#deployment-history","title":"Deployment History","text":"<p>Kedge tracks every deployment in a SQLite database.</p>"},{"location":"concepts/#whats-tracked","title":"What's Tracked","text":"Field Description Commit hash The Git commit that triggered the deployment Timestamp When the deployment occurred Status <code>success</code>, <code>failed</code>, <code>rolled_back</code> Compose content Snapshot of the compose file"},{"location":"concepts/#viewing-history","title":"Viewing History","text":"<pre><code>kedge history --repo myapp\n</code></pre> <pre><code>COMMIT    STATUS    DEPLOYED AT\nabc1234   success   2024-01-15 10:30:00\ndef5678   success   2024-01-14 15:45:00\nghi9012   failed    2024-01-14 12:00:00\n</code></pre>"},{"location":"concepts/#rollback","title":"Rollback","text":"<p>Restore a previous deployment:</p> <pre><code>kedge rollback --repo myapp abc1234\n</code></pre> <p>This:</p> <ol> <li>Retrieves the compose file from that deployment</li> <li>Applies it to Docker</li> <li>Records a new deployment with status <code>rolled_back</code></li> </ol>"},{"location":"concepts/#labels","title":"Labels","text":"<p>Kedge adds labels to managed containers for identification:</p> Label Description <code>io.kedge.managed</code> Always <code>true</code> for Kedge containers <code>io.kedge.project</code> The project name <code>io.kedge.service</code> The service name <code>io.kedge.commit</code> The Git commit hash <p>Query Kedge-managed containers:</p> <pre><code>docker ps --filter \"label=io.kedge.managed=true\"\n</code></pre>"},{"location":"configuration/","title":"Configuration","text":"<p>Kedge uses two configuration files: a per-repository <code>kedge.yaml</code> and an optional global config.</p>"},{"location":"configuration/#repository-configuration","title":"Repository Configuration","text":"<p>Each repository must have a <code>kedge.yaml</code> at the root.</p>"},{"location":"configuration/#minimal-example","title":"Minimal Example","text":"<pre><code>docker:\n  project_name: myapp\n  compose_file: docker-compose.yaml\n</code></pre>"},{"location":"configuration/#full-example","title":"Full Example","text":"<pre><code>docker:\n  project_name: myapp\n  compose_file: docker-compose.yaml\n\nreconciliation:\n  mode: auto\n\nlogging:\n  level: info\n  format: text\n</code></pre>"},{"location":"configuration/#reference","title":"Reference","text":""},{"location":"configuration/#docker","title":"<code>docker</code>","text":"Field Type Required Description <code>project_name</code> string Yes Docker Compose project name <code>compose_file</code> string Yes Path to compose file (relative to repo root)"},{"location":"configuration/#reconciliation","title":"<code>reconciliation</code>","text":"Field Type Default Description <code>mode</code> string <code>auto</code> Reconciliation mode: <code>auto</code>, <code>notify</code>, or <code>manual</code>"},{"location":"configuration/#logging","title":"<code>logging</code>","text":"Field Type Default Description <code>level</code> string <code>info</code> Log level: <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code> <code>format</code> string <code>text</code> Log format: <code>text</code> or <code>json</code>"},{"location":"configuration/#global-configuration","title":"Global Configuration","text":"<p>Optional global settings at <code>~/.config/kedge/config.yaml</code>.</p>"},{"location":"configuration/#example","title":"Example","text":"<pre><code>state:\n  path: ~/.local/share/kedge/state.db\n\nserver:\n  port: 8080\n\ngit:\n  poll_interval: 60s\n\nlogging:\n  level: info\n  format: text\n</code></pre>"},{"location":"configuration/#reference_1","title":"Reference","text":""},{"location":"configuration/#state","title":"<code>state</code>","text":"Field Type Default Description <code>path</code> string <code>~/.local/share/kedge/state.db</code> SQLite database path"},{"location":"configuration/#server","title":"<code>server</code>","text":"Field Type Default Description <code>port</code> integer <code>8080</code> HTTP server port for health endpoints"},{"location":"configuration/#git","title":"<code>git</code>","text":"Field Type Default Description <code>poll_interval</code> duration <code>60s</code> How often to check for Git changes"},{"location":"configuration/#private-repository-authentication","title":"Private Repository Authentication","text":"<p>Kedge supports SSH keys and HTTPS tokens for accessing private repositories.</p>"},{"location":"configuration/#ssh-authentication","title":"SSH Authentication","text":"<pre><code>kedge repo add git@github.com:org/private-repo.git \\\n  --ssh-private-key-path ~/.ssh/deploy_key\n</code></pre> <p>If you add an SSH URL without specifying a key, Kedge will prompt for the path interactively.</p> <p>SSH Key Permissions</p> <p>Kedge warns if your SSH key has permissions greater than <code>0600</code>. Run <code>chmod 600 ~/.ssh/your_key</code> to fix.</p>"},{"location":"configuration/#https-token-authentication","title":"HTTPS Token Authentication","text":"<pre><code># Set your token in an environment variable\nexport GITHUB_TOKEN=ghp_xxxxx\n\n# Add the repository\nkedge repo add https://github.com/org/private-repo.git \\\n  --password-env GITHUB_TOKEN\n</code></pre> <p>For providers requiring a username:</p> <pre><code>kedge repo add https://github.com/org/private-repo.git \\\n  --username x-access-token \\\n  --password-env GITHUB_TOKEN\n</code></pre>"},{"location":"configuration/#cli-flags","title":"CLI Flags","text":"Flag Description <code>--ssh-private-key-path</code> Path to SSH private key <code>--username</code> Username for HTTPS auth (default: <code>x-access-token</code>) <code>--password-env</code> Environment variable name containing the token"},{"location":"configuration/#security","title":"Security","text":"<ul> <li>Secrets are never stored - only references (file paths, env var names)</li> <li>SSH key contents are never saved to the database</li> <li>Tokens are read from environment variables at runtime</li> </ul>"},{"location":"configuration/#logging_1","title":"<code>logging</code>","text":"Field Type Default Description <code>level</code> string <code>info</code> Log level: <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code> <code>format</code> string <code>text</code> Log format: <code>text</code> or <code>json</code>"},{"location":"configuration/#environment-variables","title":"Environment Variables","text":"<p>Environment variable expansion is supported in <code>kedge.yaml</code>:</p> <pre><code>docker:\n  project_name: ${APP_NAME:-myapp}\n  compose_file: ${COMPOSE_FILE:-docker-compose.yaml}\n</code></pre>"},{"location":"configuration/#syntax","title":"Syntax","text":"Syntax Description <code>${VAR}</code> Value of <code>VAR</code>, empty if unset <code>${VAR:-default}</code> Value of <code>VAR</code>, or <code>default</code> if unset"},{"location":"configuration/#configuration-precedence","title":"Configuration Precedence","text":"<ol> <li>Repository <code>kedge.yaml</code> (highest priority)</li> <li>Global <code>~/.config/kedge/config.yaml</code></li> <li>Built-in defaults (lowest priority)</li> </ol> <p>Repository settings override global settings where applicable.</p>"},{"location":"getting-started/","title":"Getting Started","text":"<p>This guide walks you through installing Kedge and deploying your first application.</p>"},{"location":"getting-started/#installation","title":"Installation","text":""},{"location":"getting-started/#from-source","title":"From Source","text":"<pre><code>go install github.com/LoriKarikari/kedge/cmd/kedge@latest\n</code></pre>"},{"location":"getting-started/#build-from-source","title":"Build from Source","text":"<pre><code>git clone https://github.com/LoriKarikari/kedge.git\ncd kedge &amp;&amp; make build\n</code></pre>"},{"location":"getting-started/#docker","title":"Docker","text":"<pre><code>docker pull ghcr.io/lorikarikari/kedge:latest\n</code></pre>"},{"location":"getting-started/#prepare-your-repository","title":"Prepare Your Repository","text":"<p>Kedge watches Git repositories that contain a Docker Compose file and a Kedge configuration file.</p>"},{"location":"getting-started/#1-create-kedgeyaml","title":"1. Create <code>kedge.yaml</code>","text":"<p>Add this file to the root of your repository:</p> <pre><code>docker:\n  project_name: myapp\n  compose_file: docker-compose.yaml\n</code></pre> <p>This tells Kedge:</p> <ul> <li>project_name: The Docker Compose project name (used for container naming)</li> <li>compose_file: Path to your compose file (relative to repo root)</li> </ul>"},{"location":"getting-started/#2-ensure-you-have-a-docker-composeyaml","title":"2. Ensure you have a <code>docker-compose.yaml</code>","text":"<pre><code>services:\n  web:\n    image: nginx:alpine\n    ports:\n      - \"80:80\"\n  api:\n    image: myapp/api:latest\n    environment:\n      - DATABASE_URL=postgres://db:5432/app\n</code></pre>"},{"location":"getting-started/#3-push-to-git","title":"3. Push to Git","text":"<pre><code>git add kedge.yaml\ngit commit -m \"Add kedge configuration\"\ngit push\n</code></pre>"},{"location":"getting-started/#register-your-repository","title":"Register Your Repository","text":"<p>Tell Kedge about your repository:</p> <pre><code>kedge repo add https://github.com/you/your-app\n</code></pre>"},{"location":"getting-started/#options","title":"Options","text":"Flag Description Default <code>--name</code> Custom name for the repository Derived from URL <code>--branch</code> Branch to watch <code>main</code>"},{"location":"getting-started/#examples","title":"Examples","text":"<pre><code># Use defaults\nkedge repo add https://github.com/acme/webapp\n\n# Custom name and branch\nkedge repo add https://github.com/acme/webapp --name production --branch release\n\n# Private repository (uses git credentials)\nkedge repo add https://github.com/acme/private-app\n</code></pre>"},{"location":"getting-started/#verify-registration","title":"Verify Registration","text":"<pre><code>kedge repo list\n</code></pre>"},{"location":"getting-started/#start-kedge","title":"Start Kedge","text":"<pre><code>kedge serve\n</code></pre> <p>Kedge will:</p> <ol> <li>Clone all registered repositories</li> <li>Deploy the Docker Compose stacks</li> <li>Watch for Git changes</li> <li>Monitor for drift and auto-heal</li> </ol>"},{"location":"getting-started/#what-happens-next","title":"What Happens Next","text":"<ul> <li>Git push \u2192 Kedge pulls changes and redeploys</li> <li>Container stops \u2192 Kedge restarts it (in <code>auto</code> mode)</li> <li>Image changes \u2192 Kedge recreates the container</li> </ul>"},{"location":"getting-started/#verify-deployment","title":"Verify Deployment","text":""},{"location":"getting-started/#check-status","title":"Check Status","text":"<pre><code>kedge status --repo myapp\n</code></pre>"},{"location":"getting-started/#view-running-containers","title":"View Running Containers","text":"<pre><code>docker ps --filter \"label=io.kedge.managed=true\"\n</code></pre>"},{"location":"getting-started/#check-logs","title":"Check Logs","text":"<p>Kedge logs all operations:</p> <pre><code>INFO starting repo repo=myapp url=https://github.com/you/your-app\nINFO git change detected commit=abc123 message=\"Update nginx config\"\nINFO reconciliation complete changes=1\n</code></pre>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<ul> <li>Core Concepts - Understand repositories, reconciliation, and drift</li> <li>Configuration - All configuration options</li> <li>CLI Reference - Complete command documentation</li> </ul>"},{"location":"telemetry/","title":"Telemetry","text":"<p>Kedge exposes Prometheus metrics for monitoring deployments, drift detection, and reconciliation performance.</p>"},{"location":"telemetry/#metrics-endpoint","title":"Metrics Endpoint","text":"<p>Metrics are exposed at <code>/metrics</code> on the HTTP server (default port <code>8080</code>):</p> <pre><code>curl http://localhost:8080/metrics\n</code></pre>"},{"location":"telemetry/#prometheus-configuration","title":"Prometheus Configuration","text":"<p>Add Kedge as a scrape target in your <code>prometheus.yml</code>:</p> <pre><code>scrape_configs:\n  - job_name: 'kedge'\n    static_configs:\n      - targets: ['localhost:8080']\n    scrape_interval: 15s\n</code></pre>"},{"location":"telemetry/#metrics-reference","title":"Metrics Reference","text":"Metric Type Labels Description <code>kedge_info</code> Gauge <code>version</code>, <code>commit</code> Build information <code>kedge_deployments_total</code> Counter <code>repo</code>, <code>status</code> Total deployments <code>kedge_drift_detected_total</code> Counter <code>repo</code>, <code>service</code> Drift detections <code>kedge_git_polls_total</code> Counter <code>repo</code>, <code>success</code> Git poll operations <code>kedge_reconciliation_duration_seconds</code> Histogram <code>repo</code>, <code>success</code> Reconciliation duration <code>kedge_git_poll_duration_seconds</code> Histogram <code>repo</code>, <code>success</code> Git poll duration <code>kedge_services_total</code> UpDownCounter <code>repo</code>, <code>state</code> Current services by state <code>kedge_last_deployment_timestamp_seconds</code> Gauge <code>repo</code> Last deployment timestamp"},{"location":"telemetry/#label-values","title":"Label Values","text":"<p>status (deployments):</p> <ul> <li><code>success</code> - Deployment completed successfully</li> <li><code>failed</code> - Deployment failed</li> </ul> <p>success (git polls, reconciliation):</p> <ul> <li><code>true</code> - Operation succeeded</li> <li><code>false</code> - Operation failed</li> </ul> <p>state (services):</p> <ul> <li><code>running</code> - Service is running</li> <li><code>stopped</code> - Service is stopped</li> <li><code>created</code> - Service is created but not started</li> </ul>"},{"location":"telemetry/#example-queries","title":"Example Queries","text":"<p>Deployment rate per repository:</p> <pre><code>rate(kedge_deployments_total[5m])\n</code></pre> <p>Failed deployments:</p> <pre><code>sum(rate(kedge_deployments_total{status=\"failed\"}[5m])) by (repo)\n</code></pre> <p>Reconciliation p95 latency:</p> <pre><code>histogram_quantile(0.95, rate(kedge_reconciliation_duration_seconds_bucket[5m]))\n</code></pre> <p>Drift detection rate:</p> <pre><code>rate(kedge_drift_detected_total[5m])\n</code></pre>"},{"location":"telemetry/#grafana-dashboard","title":"Grafana Dashboard","text":"<p>A pre-built Grafana dashboard is available at <code>contrib/grafana/kedge-dashboard.json</code>.</p> <p>To import:</p> <ol> <li>In Grafana, go to Dashboards &gt; Import</li> <li>Upload the JSON file or paste its contents</li> <li>Select your Prometheus data source</li> <li>Click Import</li> </ol> <p>The dashboard includes:</p> <ul> <li>Kedge version info</li> <li>Total deployments counter</li> <li>Drift detection counter</li> <li>Git poll counter</li> <li>Deployment rate over time</li> <li>Reconciliation duration (p50/p95)</li> <li>Git poll rate and duration</li> <li>Last deployment timestamp</li> <li>Go runtime goroutines</li> </ul>"},{"location":"cli/","title":"CLI Reference","text":"<p>Complete reference for the <code>kedge</code> command-line interface.</p>"},{"location":"cli/#usage","title":"Usage","text":"<pre><code>kedge &lt;command&gt; [flags]\n</code></pre>"},{"location":"cli/#commands","title":"Commands","text":""},{"location":"cli/#repository-management","title":"Repository Management","text":"Command Description kedge repo add Register a repository kedge repo list List registered repositories kedge repo remove Remove a repository"},{"location":"cli/#controller","title":"Controller","text":"Command Description kedge serve Start the GitOps controller"},{"location":"cli/#operations","title":"Operations","text":"Command Description kedge status Show deployment status kedge diff Show drift between desired and actual state kedge sync Trigger immediate reconciliation"},{"location":"cli/#deployment-history","title":"Deployment History","text":"Command Description kedge history Show deployment history kedge rollback Rollback to a previous deployment"},{"location":"cli/#diagnostics","title":"Diagnostics","text":"Command Description kedge healthcheck Check server health kedge version Print version information"},{"location":"cli/#global-flags","title":"Global Flags","text":"Option Description <code>-h</code>, <code>--help</code> Display help for the command"},{"location":"cli/#getting-help","title":"Getting Help","text":"<pre><code>kedge --help\nkedge repo --help\nkedge repo add --help\n</code></pre>"},{"location":"cli/diff/","title":"kedge diff","text":""},{"location":"cli/diff/#usage","title":"Usage","text":"<pre><code>kedge diff --repo &lt;name&gt;\n</code></pre>"},{"location":"cli/diff/#description","title":"Description","text":"<p>Compares the desired state (from <code>docker-compose.yaml</code>) against the actual state (running containers) and displays any differences.</p>"},{"location":"cli/diff/#flags","title":"Flags","text":"Option Description Default <code>--repo</code> Repository name (required)"},{"location":"cli/diff/#examples","title":"Examples","text":"<pre><code>kedge diff --repo webapp\n</code></pre>"},{"location":"cli/diff/#output-with-drift","title":"Output (with drift)","text":"<pre><code>Repository: webapp\n\nService: web\n  Status: Image mismatch\n  Expected: nginx:1.25\n  Actual: nginx:1.24\n\nService: worker\n  Status: Not running\n  Expected: running\n  Actual: exited\n</code></pre>"},{"location":"cli/diff/#output-in-sync","title":"Output (in sync)","text":"<pre><code>Repository: webapp\nStatus: In sync\n</code></pre>"},{"location":"cli/diff/#related-commands","title":"Related Commands","text":"<ul> <li>kedge sync</li> <li>kedge status</li> </ul>"},{"location":"cli/healthcheck/","title":"kedge healthcheck","text":""},{"location":"cli/healthcheck/#usage","title":"Usage","text":"<pre><code>kedge healthcheck [flags]\n</code></pre>"},{"location":"cli/healthcheck/#description","title":"Description","text":"<p>Connects to the Kedge server's health endpoint and reports the status. Returns exit code <code>0</code> if healthy, <code>1</code> if unhealthy.</p>"},{"location":"cli/healthcheck/#flags","title":"Flags","text":"Option Description Default <code>--port</code> Server port to check <code>8080</code>"},{"location":"cli/healthcheck/#examples","title":"Examples","text":"<pre><code># Check default port\nkedge healthcheck\n\n# Check custom port\nkedge healthcheck --port 9090\n\n# Use in scripts\nif kedge healthcheck; then\n  echo \"Kedge is running\"\nelse\n  echo \"Kedge is not running\"\nfi\n</code></pre>"},{"location":"cli/healthcheck/#output-healthy","title":"Output (healthy)","text":"<pre><code>Kedge server is healthy\n</code></pre>"},{"location":"cli/healthcheck/#output-unhealthy","title":"Output (unhealthy)","text":"<pre><code>Error: could not connect to Kedge server at localhost:8080\n</code></pre>"},{"location":"cli/healthcheck/#exit-codes","title":"Exit Codes","text":"Code Description <code>0</code> Server is healthy <code>1</code> Server is unreachable or unhealthy"},{"location":"cli/healthcheck/#related-commands","title":"Related Commands","text":"<ul> <li>kedge serve</li> <li>kedge version</li> </ul>"},{"location":"cli/history/","title":"kedge history","text":""},{"location":"cli/history/#usage","title":"Usage","text":"<pre><code>kedge history --repo &lt;name&gt;\n</code></pre>"},{"location":"cli/history/#description","title":"Description","text":"<p>Displays the deployment history including commit hashes, status, and timestamps. Use this to find a commit hash for rollback.</p>"},{"location":"cli/history/#flags","title":"Flags","text":"Option Description Default <code>--repo</code> Repository name (required)"},{"location":"cli/history/#examples","title":"Examples","text":"<pre><code>kedge history --repo webapp\n</code></pre>"},{"location":"cli/history/#output","title":"Output","text":"<pre><code>Repository: webapp\n\nCOMMIT    STATUS       DEPLOYED AT\nabc1234   success      2024-01-15 10:30:00\ndef5678   success      2024-01-14 15:45:00\nghi9012   failed       2024-01-14 12:00:00\njkl3456   rolled_back  2024-01-13 09:00:00\n</code></pre>"},{"location":"cli/history/#status-values","title":"Status Values","text":"Status Description <code>success</code> Deployment completed successfully <code>failed</code> Deployment encountered an error <code>rolled_back</code> Deployment was rolled back from <code>pending</code> Deployment in progress <code>skipped</code> No changes were necessary"},{"location":"cli/history/#related-commands","title":"Related Commands","text":"<ul> <li>kedge rollback</li> <li>kedge status</li> </ul>"},{"location":"cli/rollback/","title":"kedge rollback","text":""},{"location":"cli/rollback/#usage","title":"Usage","text":"<pre><code>kedge rollback --repo &lt;name&gt; &lt;commit&gt;\n</code></pre>"},{"location":"cli/rollback/#description","title":"Description","text":"<p>Restores a previous deployment by:</p> <ol> <li>Retrieving the compose file snapshot from the specified commit</li> <li>Applying it to Docker</li> <li>Recording a new deployment entry with the rollback</li> </ol>"},{"location":"cli/rollback/#flags","title":"Flags","text":"Option Description Default <code>--repo</code> Repository name (required)"},{"location":"cli/rollback/#arguments","title":"Arguments","text":"Argument Description <code>commit</code> Commit hash to rollback to (from <code>kedge history</code>)"},{"location":"cli/rollback/#examples","title":"Examples","text":"<pre><code># View history to find commit\nkedge history --repo webapp\n\n# Rollback to specific commit\nkedge rollback --repo webapp abc1234\n\n# Verify the rollback\nkedge status --repo webapp\n</code></pre>"},{"location":"cli/rollback/#output","title":"Output","text":"<pre><code>Rolling back webapp to abc1234...\nRetrieved compose file from deployment\nApplying configuration...\nRollback complete\n\nCurrent deployment:\n  Commit: abc1234\n  Status: success\n  Services: 3 running\n</code></pre>"},{"location":"cli/rollback/#related-commands","title":"Related Commands","text":"<ul> <li>kedge history</li> <li>kedge status</li> </ul>"},{"location":"cli/serve/","title":"kedge serve","text":""},{"location":"cli/serve/#usage","title":"Usage","text":"<pre><code>kedge serve\n</code></pre>"},{"location":"cli/serve/#description","title":"Description","text":"<p>Starts the Kedge controller which:</p> <ol> <li>Loads all registered repositories from the database</li> <li>Clones repositories (or pulls latest if already cloned)</li> <li>Deploys Docker Compose stacks</li> <li>Watches for Git changes (polls at configured interval)</li> <li>Monitors for drift and reconciles based on mode</li> <li>Exposes HTTP health endpoints</li> </ol> <p>The controller runs until terminated with <code>SIGINT</code> (Ctrl+C) or <code>SIGTERM</code>.</p>"},{"location":"cli/serve/#examples","title":"Examples","text":"<pre><code># Start the controller\nkedge serve\n\n# Run in background\nkedge serve &amp;\n\n# Run with Docker\ndocker run -v /var/run/docker.sock:/var/run/docker.sock ghcr.io/lorikarikari/kedge serve\n</code></pre>"},{"location":"cli/serve/#output","title":"Output","text":"<pre><code>INFO starting kedge server port=8080\nINFO starting repo repo=webapp url=https://github.com/acme/webapp\nINFO initial reconcile complete repo=webapp\nINFO git change detected repo=webapp commit=abc1234\nINFO reconciliation complete repo=webapp changes=1\n</code></pre>"},{"location":"cli/serve/#health-endpoints","title":"Health Endpoints","text":"<p>While running, Kedge exposes HTTP endpoints:</p> Endpoint Description Success <code>GET /health</code> Server is running <code>200 OK</code> <code>GET /ready</code> At least one repo is synced <code>200 OK</code> <code>GET /metrics</code> Prometheus metrics <code>200 OK</code> <p>For detailed metrics documentation, see Telemetry.</p> <p>Default port: <code>8080</code>. Configure in <code>~/.config/kedge/config.yaml</code>:</p> <pre><code>server:\n  port: 8080\n</code></pre>"},{"location":"cli/serve/#graceful-shutdown","title":"Graceful Shutdown","text":"<pre><code># Send SIGINT or SIGTERM\nkill -SIGTERM $(pgrep kedge)\n</code></pre> <pre><code>INFO shutting down...\nINFO stopped repo repo=webapp\nINFO shutdown complete\n</code></pre>"},{"location":"cli/serve/#related-commands","title":"Related Commands","text":"<ul> <li>kedge repo add</li> <li>kedge healthcheck</li> <li>kedge status</li> </ul>"},{"location":"cli/status/","title":"kedge status","text":""},{"location":"cli/status/#usage","title":"Usage","text":"<pre><code>kedge status --repo &lt;name&gt;\n</code></pre>"},{"location":"cli/status/#description","title":"Description","text":"<p>Displays the current deployment status including the active commit, deployment time, and the state of each service.</p>"},{"location":"cli/status/#flags","title":"Flags","text":"Option Description Default <code>--repo</code> Repository name (required)"},{"location":"cli/status/#examples","title":"Examples","text":"<pre><code>kedge status --repo webapp\n</code></pre>"},{"location":"cli/status/#output","title":"Output","text":"<pre><code>Repository: webapp\nStatus: Running\nCommit: abc1234\nDeployed: 2024-01-15 10:30:00\n\nServices:\n  web: running (nginx:1.25)\n  api: running (myapp/api:v1.2.3)\n  worker: running (myapp/worker:v1.2.3)\n</code></pre>"},{"location":"cli/status/#related-commands","title":"Related Commands","text":"<ul> <li>kedge diff</li> <li>kedge history</li> </ul>"},{"location":"cli/sync/","title":"kedge sync","text":""},{"location":"cli/sync/#usage","title":"Usage","text":"<pre><code>kedge sync --repo &lt;name&gt;\n</code></pre>"},{"location":"cli/sync/#description","title":"Description","text":"<p>Forces an immediate reconciliation for a repository:</p> <ol> <li>Pulls the latest changes from Git</li> <li>Compares desired state vs actual state</li> <li>Applies any necessary changes</li> </ol> <p>Useful when using <code>manual</code> reconciliation mode or to force a redeploy.</p>"},{"location":"cli/sync/#flags","title":"Flags","text":"Option Description Default <code>--repo</code> Repository name (required)"},{"location":"cli/sync/#examples","title":"Examples","text":"<pre><code># Sync a repository\nkedge sync --repo webapp\n\n# Check diff first, then sync\nkedge diff --repo webapp\nkedge sync --repo webapp\n</code></pre>"},{"location":"cli/sync/#output","title":"Output","text":"<pre><code>Syncing webapp...\nPulled latest changes (commit: def5678)\nReconciliation complete: 2 services updated\n</code></pre>"},{"location":"cli/sync/#related-commands","title":"Related Commands","text":"<ul> <li>kedge diff</li> <li>kedge status</li> </ul>"},{"location":"cli/version/","title":"kedge version","text":""},{"location":"cli/version/#usage","title":"Usage","text":"<pre><code>kedge version\n</code></pre>"},{"location":"cli/version/#description","title":"Description","text":"<p>Displays the Kedge version and build commit.</p>"},{"location":"cli/version/#examples","title":"Examples","text":"<pre><code>kedge version\n</code></pre>"},{"location":"cli/version/#output","title":"Output","text":"<pre><code>kedge v0.3.0 (abc1234)\n</code></pre>"},{"location":"cli/version/#related-commands","title":"Related Commands","text":"<ul> <li>kedge healthcheck</li> </ul>"},{"location":"cli/repo/add/","title":"kedge repo add","text":""},{"location":"cli/repo/add/#usage","title":"Usage","text":"<pre><code>kedge repo add &lt;url&gt; [flags]\n</code></pre>"},{"location":"cli/repo/add/#description","title":"Description","text":"<p>Registers a Git repository with Kedge. The repository must contain a <code>kedge.yaml</code> configuration file at its root. Once registered, the repository will be cloned and deployed when you run <code>kedge serve</code>.</p>"},{"location":"cli/repo/add/#flags","title":"Flags","text":"Option Description Default <code>--name</code> Custom name for the repository Derived from URL <code>--branch</code> Branch to watch <code>main</code>"},{"location":"cli/repo/add/#examples","title":"Examples","text":"<pre><code># Register with defaults (name derived from URL)\nkedge repo add https://github.com/acme/webapp\n\n# Register with custom name\nkedge repo add https://github.com/acme/webapp --name production\n\n# Register specific branch\nkedge repo add https://github.com/acme/webapp --branch develop\n\n# Full example\nkedge repo add https://github.com/acme/webapp --name staging --branch release\n</code></pre>"},{"location":"cli/repo/add/#related-commands","title":"Related Commands","text":"<ul> <li>kedge repo list</li> <li>kedge repo remove</li> <li>kedge serve</li> </ul>"},{"location":"cli/repo/list/","title":"kedge repo list","text":""},{"location":"cli/repo/list/#usage","title":"Usage","text":"<pre><code>kedge repo list\n</code></pre>"},{"location":"cli/repo/list/#description","title":"Description","text":"<p>Displays all repositories registered with Kedge, including their URLs and watched branches.</p>"},{"location":"cli/repo/list/#examples","title":"Examples","text":"<pre><code>kedge repo list\n</code></pre>"},{"location":"cli/repo/list/#output","title":"Output","text":"<pre><code>NAME        URL                                    BRANCH\nwebapp      https://github.com/acme/webapp         main\napi         https://github.com/acme/api            main\nworker      https://github.com/acme/worker         develop\n</code></pre>"},{"location":"cli/repo/list/#related-commands","title":"Related Commands","text":"<ul> <li>kedge repo add</li> <li>kedge repo remove</li> </ul>"},{"location":"cli/repo/remove/","title":"kedge repo remove","text":""},{"location":"cli/repo/remove/#usage","title":"Usage","text":"<pre><code>kedge repo remove &lt;name&gt;\n</code></pre>"},{"location":"cli/repo/remove/#description","title":"Description","text":"<p>Removes a repository from Kedge's database. This stops Kedge from watching the repository, but does not stop running containers. To stop containers, use <code>docker compose down</code> before removing.</p>"},{"location":"cli/repo/remove/#arguments","title":"Arguments","text":"Argument Description <code>name</code> Name of the repository to remove"},{"location":"cli/repo/remove/#examples","title":"Examples","text":"<pre><code># Remove a repository\nkedge repo remove webapp\n\n# Stop containers first, then remove\ncd .kedge/repos/webapp &amp;&amp; docker compose down\nkedge repo remove webapp\n</code></pre>"},{"location":"cli/repo/remove/#related-commands","title":"Related Commands","text":"<ul> <li>kedge repo list</li> <li>kedge repo add</li> </ul>"}]}